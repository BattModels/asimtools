<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>README &mdash; asimtools 0.0.0 documentation</title>
      <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="_static/jquery.js"></script>
        <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/sphinx_highlight.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Running an existing script" href="usage.html" />
    <link rel="prev" title="Welcome to asimtools’s documentation!" href="index.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            asimtools
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">README</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#atomic-simulation-tools">Atomic SIMulation Tools</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#developer-philosophy">Developer philosophy</a></li>
<li class="toctree-l3"><a class="reference internal" href="#philosophy-on-user-experience">Philosophy on User Experience</a></li>
<li class="toctree-l3"><a class="reference internal" href="#getting-started">Getting Started</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#installing">Installing</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#running-the-tests">Running the tests</a></li>
<li class="toctree-l3"><a class="reference internal" href="#contributing">Contributing</a></li>
<li class="toctree-l3"><a class="reference internal" href="#authors">Authors</a></li>
<li class="toctree-l3"><a class="reference internal" href="#license">License</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="usage.html">Running Scripts</a></li>
<li class="toctree-l1"><a class="reference internal" href="asimplify.html">Custom Scripts</a></li>
<li class="toctree-l1"><a class="reference internal" href="workflows.html">Workflows</a></li>
<li class="toctree-l1"><a class="reference internal" href="modules.html">API Docs</a></li>
<li class="toctree-l1"><a class="reference internal" href="include_contributing.html">Contributing</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">asimtools</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">README</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/include_readme.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="readme">
<h1>README<a class="headerlink" href="#readme" title="Permalink to this heading"></a></h1>
<section id="atomic-simulation-tools">
<h2>Atomic SIMulation Tools<a class="headerlink" href="#atomic-simulation-tools" title="Permalink to this heading"></a></h2>
<p>This package is a lightweight workflow and simulation manager for reproducible
atomistic simulations that can be transferred across environments, calculators
and structures. By using in-built or user-defined scripts and utilities, users
can run/build their own simulation recipes and automagically scale them on
slurm based clusters. The core idea is to separate the dependence of the
atomistic potential/calculator and the simulations steps thereby allowing the
same simulation to be run with multiple calculators and the same calculator to
be used for multiple simulations. Input and output files must follow a strict
format so that consistent analysis pipelines can be used across users</p>
<section id="developer-philosophy">
<h3>Developer philosophy<a class="headerlink" href="#developer-philosophy" title="Permalink to this heading"></a></h3>
<p>The goal of asimtools is to push all the complexity of workflow
management, best-practices, file management etc. into the backend such that the
everyday user only has to handle input files for existing workflows and script
files for workflows they want to implement. The following are the guiding
principles for how asimtools should work:</p>
<ul class="simple">
<li><p>Scripts should resemble boilerplate ASE code as much as possible.</p></li>
<li><p>Scripts should not explicitly depend on a calculator</p></li>
<li><p>Scripts should not explicitly depend on the context in which they run</p></li>
<li><p>It should be easy to debug individual scripts/parts in large workflows. In
addition, it should always be possible to debug/resubmit jobs without using
asimtools.</p></li>
<li><p>input file structure and format should be standard across all scripts. In
addition all input parameters should match how they would like without
asimtools i.e. do not provide an API! This means extensive use of importlib.</p></li>
<li><p>output file structure should be predictable across all scripts</p></li>
<li><p>Job progress tracking must be incorporated</p></li>
<li><p>Best practices should be built-in e.g. if multiple jobs of the same slurm
context are submitted simulataneously, it must be a job array</p></li>
</ul>
</section>
<section id="philosophy-on-user-experience">
<h3>Philosophy on User Experience<a class="headerlink" href="#philosophy-on-user-experience" title="Permalink to this heading"></a></h3>
<p>The philosophy is to build “simulations” using building blocks of scripts.
These scripts can be as complicated/efficient as you make them using any
external packages you want and can be optimized with time but can still be run
within the framework. This allows a test friendly way to transition from say a
tutorial on the ASE/pymatgen website to an asimtools script. So while
complicated wrappers are discouraged, they would still work as long as the
script works. The benefit out of the box is that you can make your script
independent of calculator or input structures and submit them easily.</p>
</section>
<section id="getting-started">
<h3>Getting Started<a class="headerlink" href="#getting-started" title="Permalink to this heading"></a></h3>
<p>These instructions will give you a copy of the project up and running on
your local machine for development and testing purposes.</p>
<section id="installing">
<h4>Installing<a class="headerlink" href="#installing" title="Permalink to this heading"></a></h4>
<p>You can install asimtools in a new conda environment using:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">conda</span> <span class="n">create</span> <span class="o">-</span><span class="n">n</span> <span class="n">asimtools</span> <span class="n">python</span><span class="o">=</span><span class="mf">3.9</span>
<span class="n">conda</span> <span class="n">activate</span> <span class="n">asimtools</span>

<span class="n">conda</span> <span class="n">install</span> <span class="n">ase</span> <span class="o">-</span><span class="n">c</span> <span class="n">conda</span><span class="o">-</span><span class="n">forge</span>

<span class="n">git</span> <span class="n">clone</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">github</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">BattModels</span><span class="o">/</span><span class="n">asimtools</span><span class="o">.</span><span class="n">git</span>
<span class="n">cd</span> <span class="n">asimtools</span>
<span class="n">pip</span> <span class="n">install</span> <span class="o">-</span><span class="n">e</span> <span class="o">.</span>
</pre></div>
</div>
<p>This installs the base package in developer mode so that you do not have to
reinstall if you make changes to the core package.</p>
<p>Individual calculators may need external packages for loading those
calculators. Similarly some scripts e.g. <code class="docutils literal notranslate"><span class="pre">lammps.py</span></code> might also need external packages to be used. It is up to the user to make sure those are installed.</p>
<p>You will also need to setup some environment variables, these variables point
to a <code class="docutils literal notranslate"><span class="pre">env_input.yaml</span></code> and <code class="docutils literal notranslate"><span class="pre">calc_input.yaml</span></code> with your favorite configs since
these are commonly shared among simulations. You can also directly specify them
when running <code class="docutils literal notranslate"><span class="pre">asim-execute</span></code> (See <code class="docutils literal notranslate"><span class="pre">asim-execute</span> <span class="pre">-h</span></code>).
Examples of these files can be found in the examples.</p>
<p>Add the following to your <code class="docutils literal notranslate"><span class="pre">.bashrc</span></code></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">export</span> <span class="n">ASIMTOOLS_ENV_INPUT</span><span class="o">=/</span><span class="n">path</span><span class="o">/</span><span class="n">to</span><span class="o">/</span><span class="n">my</span><span class="o">/</span><span class="k">global</span><span class="o">/</span><span class="n">env_input</span><span class="o">.</span><span class="n">yaml</span>
<span class="n">export</span> <span class="n">ASIMTOOLS_CALC_INPUT</span><span class="o">=/</span><span class="n">path</span><span class="o">/</span><span class="n">to</span><span class="o">/</span><span class="n">my</span><span class="o">/</span><span class="k">global</span><span class="o">/</span><span class="n">calc_input</span><span class="o">.</span><span class="n">yaml</span>
<span class="n">export</span> <span class="n">ASIMTOOLS_SCRIPT_DIR</span><span class="o">=/</span><span class="n">path</span><span class="o">/</span><span class="n">to</span><span class="o">/</span><span class="n">my</span><span class="o">/</span><span class="n">script</span><span class="o">/</span><span class="nb">dir</span>
</pre></div>
</div>
<!-- ## Examples -->
<!-- Below are a few examples on how to run already implemented scripts. -->
<!--
The first thing to understand is the difference between `asim-execute sim_input.yaml` and
`asim-run sim_input.yaml`. The latter runs the chosen script in whatever location
and environment it happens to be launched from i.e. equivalent to
`python my_script.py sim_input.yaml` whereas the latter runs submits the job
that runs the script e.g. it will go to the work directory and launch a slurm job
from there containing `asim-run sim_input.yaml`.  `asim-execute` is essentially
"environment-aware" and runs the script in the environment specified by `env_id`
whereas `asim-run` does not use `env_id` at all. -->
<!-- A template is provided for writing a new script called `template.py`

We provide a standard set of building block scripts for simulations/workflows that tend to form components of large simulations. Let us consider some examples.
To see details of their arguments (`args`), see their docstrings (which don't exist yet :( )

1. The simplest are "unit" scripts which do not internally call other scripts
or depend on results from other scripts.
The simplest example is `singlepoint.py` which runs an energy/force/stress calculation
on a single structure. To launch in your environment of choice specified by
`env_id` in `sim_input.yaml` use `asim-execute sim_input.yaml`. See `asim-execute -h`.
For all scripts, you have the ability to specify the `env_input.yaml` and `calc_input.yaml` or
skip them to use the global files specified in `ASE_CALC_INPUT` and
`ASE_ENV_INPUT`. Note that many scripts don't need `calc_input.yaml` if they
just do some preprocessing or analysis. Another example is `atom_relax.py`.
*Exercise: Add `cell_relax.py` based on `atom_relax.py`*

2. Another type are "parent" scripts which launch multiple "child" scripts in parallel.
An example is `image_array.py` which runs the same simulation on multiple
images e.g. you want the energies of all the structures in a database. Note
that you only need to point to the images, the env and the calc in the sim_input,
The script, which uses a DistributedJob object automatically handles whether to
submit jobs using a slurm array, individual slurm jobs or one after the other
depending on the specified `env_id`. Another example is
`strong_scaling.strong_scaling.py`.
*Exercise: Implement `env_array.py` and `calc_array.py` based on `image_array.py` and `strong_scaling.py`.*

3. The last major type of "parent" script are chained scripts. These scripts run one
**UnitJob** after the other based on a specified workflow. The job automatically runs
one job after another or submits slurm jobs with appropriate dependencies. Note
that if one of the unitjobs internally calls another script such as
`image_array.py`, then the slurm dependencies will fail but everything else should work.
In this casea, the current workaround is to set `submit=false` for the stages of
the chain that would fail due to a previous array/chain job. Then rerun `asim-execute`
again with `submit=true`, It should automatically skip the completed steps. See `eos.eos.py`
and the corresponding example. An example to help understand the genera; chained sim_input is
`chained`

4. Hybrid jobs combine multiple of these elements e.g. `eos.eos.py` runs a
`preprocessing` script to prepare the scaled structures followed by a UnitJob that submits
an `image_array` for each scaled structure and finally a unitjob to `postprocess`
the results from the array. It is possible to
- build hybrid scripts in python without using existing asimtools scripts
- running a `chained.py` on a `sim_input.yaml` with the correct format that runs scripts that are already defined
- to write a script such that it directly manipulates Job objects. This is the most flexible and robust but ofcourse most complicated
*Exercise: Run the eos calculation without writing any new scripts, simply using the scripts in the core (image_array) and eos subfolder (preprocessing and postprocessing).*
The key is being able to to point to the correct files for each step before the calculation is run. -->
</section>
</section>
<section id="running-the-tests">
<h3>Running the tests<a class="headerlink" href="#running-the-tests" title="Permalink to this heading"></a></h3>
<p>To run all tests from the tests directory, call:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>pytest
</pre></div>
</div>
<p>To run the test suite on a component <code class="docutils literal notranslate"><span class="pre">component.py</span></code> , call:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>pytest test_component.py
</pre></div>
</div>
<!-- ## Basic example

Simulations are run by providing a `*calc_input.yaml` and `*sim_input.yaml` file which specify
the calculator (and the environment it runs in) and the simulation parameters which are specific
to the simulation being run. The recommended method for calling scripts is to use

```
asim-run *calc_input.yaml *sim_input.yaml
``` -->
</section>
<section id="contributing">
<h3>Contributing<a class="headerlink" href="#contributing" title="Permalink to this heading"></a></h3>
<p>Please read <a class="reference internal" href="CONTRIBUTING.html"><span class="std std-doc">CONTRIBUTING.md</span></a> for details on our code
of conduct, and the process for submitting pull requests to us.</p>
</section>
<section id="authors">
<h3>Authors<a class="headerlink" href="#authors" title="Permalink to this heading"></a></h3>
<ul class="simple">
<li><p><strong>Keith Phuthi</strong>
<a class="reference external" href="https://github.com/mkphuthi">mkphuthi</a></p></li>
<li><p><strong>Emil Annevelink</strong>
<a class="reference external" href="https://github.com/emilannevelink">emilannevelink</a></p></li>
</ul>
<p>See also the list of
<a class="reference external" href="https://github.com/BattModels/asimtools.git/contributors">contributors</a>
who participated in this project.</p>
</section>
<section id="license">
<h3>License<a class="headerlink" href="#license" title="Permalink to this heading"></a></h3>
<p>This project is licensed under the MIT License</p>
<!-- ## Acknowledgments

  - Hat tip to anyone whose code is used --></section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="index.html" class="btn btn-neutral float-left" title="Welcome to asimtools’s documentation!" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="usage.html" class="btn btn-neutral float-right" title="Running an existing script" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023, Mgcini Keith Phuthi, Emil Annevelink.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>